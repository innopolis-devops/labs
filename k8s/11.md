## Main part
1. Create a secret in your cluster using `kubectl`. 

```bash
[nailya@nailya k8s]$ kubectl create secret generic nailyav-secret \
    --from-literal=username='nailyav' \
    --from-literal=password='nailyav'
secret/nailyav-secret created
```

```bash
[nailya@nailya k8s]$ kubectl describe secret nailyav-secret
Name:         nailyav-secret
Namespace:    default
Labels:       <none>
Annotations:  <none>

Type:  Opaque

Data
====
password:  7 bytes
username:  7 bytes
```

2. Verify and decode your secret
```bash
[nailya@nailya k8s]$ kubectl get secret nailyav-secret
NAME             TYPE     DATA   AGE
nailyav-secret   Opaque   2      61s
```

```bash
[nailya@nailya k8s]$ kubectl get secret nailyav-secret -o jsonpath='{.data}'
{"password":"bmFpbHlhdg==","username":"bmFpbHlhdg=="}
```

```bash
[nailya@nailya k8s]$ kubectl get secret nailyav-secret --template={{.data.username}} | base64 -d
nailyav
```

3. Using `helm`
```bash
[nailya@nailya k8s]$ helm plugin install https://github.com/jkroepke/helm-secrets --version v4.2.0
Installed plugin: secrets
```

```bash
[nailya@nailya k8s]$ gpg --gen-key
gpg (GnuPG) 2.2.39; Copyright (C) 2022 g10 Code GmbH
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.

GnuPG должен составить идентификатор пользователя для идентификации ключа.

Ваше полное имя: nailyav
Адрес электронной почты: nailyavaliull1409@gmail.com
Вы выбрали следующий идентификатор пользователя:
    "nailyav <nailyavaliull1409@gmail.com>"

Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o
Необходимо получить много случайных чисел. Желательно, чтобы Вы
в процессе генерации выполняли какие-то другие действия (печать
на клавиатуре, движения мыши, обращения к дискам); это даст генератору
случайных чисел больше возможностей получить достаточное количество энтропии.
Необходимо получить много случайных чисел. Желательно, чтобы Вы
в процессе генерации выполняли какие-то другие действия (печать
на клавиатуре, движения мыши, обращения к дискам); это даст генератору
случайных чисел больше возможностей получить достаточное количество энтропии.
открытый и секретный ключи созданы и подписаны.
```

```bash
[nailya@nailya k8s]$ sops -p <key> secrets.yaml
INFO: secrets.yaml doesn't exist, creating it.
INFO: generating and storing data encryption key
INFO: temp file created at /tmp/tmpjds1vom1.yaml
INFO: file written to secrets.yaml
```

```bash
[nailya@nailya k8s]$ helm secrets install app-python ./app-python -f ./secrets.yaml
gpg: зашифровано 3072-битным ключом RSA с идентификатором <id>, созданным 2022-11-15
      "nailyav <nailyavaliull1409@gmail.com>"
[helm-secrets] Decrypt: ./secrets.yaml
NAME: app-python
LAST DEPLOYED: Tue Nov 15 04:18:32 2022
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
     NOTE: It may take a few minutes for the LoadBalancer IP to be available.
           You can watch the status of by running 'kubectl get --namespace default svc -w app-python-app-python'
  export SERVICE_IP=$(kubectl get svc --namespace default app-python-app-python --template "{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}")
  echo http://$SERVICE_IP:80

[helm-secrets] Removed: ./secrets.yaml.dec
```

```bash
[nailya@nailya k8s]$ kubectl get pods
NAME                                           READY   STATUS    RESTARTS   AGE
app-python-app-python-7f30n23881-ldve4         1/1     Running   0          15s
```

```bash
[nailya@nailya k8s]$ kubectl exec app-python-app-python-7f30n23881-ldve4 -- printenv | grep MY_PASSWORD
MY_PASSWORD=nailyav
```

4. Set up requests and limits for CPU and memory for your application and test that it works

```bash
$ kubectl describe pod app-python-app-python-7f30n23881-ldve4
    ...
    Limits:
      cpu:     100m
      memory:  128Mi
    Requests:
      cpu:      100m
      memory:   128Mi
    ...
```

## Bonus

5. Update your helm chart with several environment variables, but use named templates, move them to `_helpers.tpl` file:

```bash
$ kubectl describe pod app-python-app-python-7f30n23881-ldve4 | grep ENV
      ENV1:     1
      ENV2:     2
```
